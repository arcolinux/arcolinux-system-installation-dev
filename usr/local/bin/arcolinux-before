#!/bin/bash
echo "#################################"
echo "Start arcolinux-before"
echo "#################################"
echo
echo "#################################"
echo "Populate Core Team keys"
echo "#################################"
echo
pacman-key --init
pacman-key --populate archlinux
pacman-key --populate arcolinux
pacman-key --populate chaotic
echo

if [  -f ${ROOT}/tmp/grubselected ]; then
	echo "#################################"
	echo "Copy grub Vimix theme (archiso deletes /boot when making the ISO)"
	echo "#################################"
	mkdir -p /boot/grub/themes
	cp -Rf /usr/share/grub/themes/Vimix /boot/grub/themes/
fi

if [ -f ${ROOT}/tmp/refindselected ]; then
	echo "#################################"
	echo "Copy refind theme (archiso deletes /boot when making the ISO)"
	echo "#################################"
	mkdir -p /boot/efi/EFI/refind/themes/
	cp -Rf /usr/share/refind/themes/arco-refind/ /boot/efi/EFI/refind/themes/
fi

echo
echo "#################################"
echo "Changing into our own linux.preset"
echo "#################################"
mv -v /etc/mkinitcpio.d/arcolinux /etc/mkinitcpio.d/linux.preset
echo
echo "#################################"
echo "End arcolinux-before"
echo "#################################"
echo
